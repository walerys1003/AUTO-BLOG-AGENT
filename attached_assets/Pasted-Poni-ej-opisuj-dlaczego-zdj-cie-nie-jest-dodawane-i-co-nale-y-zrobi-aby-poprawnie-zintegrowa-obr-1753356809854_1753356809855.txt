PoniÅ¼ej opisujÄ™ dlaczego zdjÄ™cie nie jest dodawane i co naleÅ¼y zrobiÄ‡, aby poprawnie zintegrowaÄ‡ obraz jako featured image (obraz gÅ‚Ã³wny) do posta WordPressowego przez REST API.

âœ… Co dziaÅ‚a:
ArtykuÅ‚ jest poprawnie generowany i publikowany na WordPressie.

Agent komunikuje siÄ™ z API WordPressa.

TytuÅ‚, treÅ›Ä‡, tagi, kategorie i inne metadane sÄ… przesyÅ‚ane i publikowane.

âŒ Co nie dziaÅ‚a:
Brakuje featured image (obrazka gÅ‚Ã³wnego) przypisanego do posta, mimo Å¼e adres obrazka z Unsplash (lub Pexels/Google Image) jest dostÄ™pny.

âœ… Instrukcja: Jak dodaÄ‡ zdjÄ™cie z Unsplash i przypisaÄ‡ je jako featured image w WordPressie (REST API)
1. Krok po kroku â€“ co powinien zrobiÄ‡ agent w Pythonie
ğŸ” Krok 1: Pobierz obraz z Unsplash
Masz link URL, np. https://images.unsplash.com/photo-XYZ. Pobierz ten plik binarnie w Pythonie:

python
Kopiuj
Edytuj
import requests

def download_image(url):
    response = requests.get(url)
    if response.status_code == 200:
        return response.content  # zwrÃ³ci dane binarne obrazu
    else:
        raise Exception("Nie udaÅ‚o siÄ™ pobraÄ‡ obrazu z Unsplash.")
â˜ï¸ Krok 2: WyÅ›lij obraz do WordPressa jako media (endpoint: /wp-json/wp/v2/media)
python
Kopiuj
Edytuj
def upload_image_to_wp(image_data, filename, jwt_token):
    headers = {
        "Authorization": f"Bearer {jwt_token}",
        "Content-Disposition": f'attachment; filename="{filename}"',
        "Content-Type": "image/jpeg"
    }

    response = requests.post(
        "https://twojblog.pl/wp-json/wp/v2/media",
        headers=headers,
        data=image_data
    )

    if response.status_code == 201:
        return response.json()['id']  # Zwraca ID media
    else:
        raise Exception(f"BÅ‚Ä…d przesyÅ‚ania zdjÄ™cia: {response.text}")
ğŸ–¼ï¸ Krok 3: Dodaj featured_media do artykuÅ‚u WordPress
Po opublikowaniu posta lub przy jego tworzeniu dodaj featured_media:

python
Kopiuj
Edytuj
def create_post(title, content, excerpt, featured_media_id, jwt_token):
    headers = {
        "Authorization": f"Bearer {jwt_token}",
        "Content-Type": "application/json"
    }

    post_data = {
        "title": title,
        "content": content,
        "excerpt": excerpt,
        "status": "publish",
        "categories": [ID_KATEGORII],
        "tags": [ID_TAGÃ“W],
        "featured_media": featured_media_id
    }

    response = requests.post("https://twojblog.pl/wp-json/wp/v2/posts", json=post_data, headers=headers)

    if response.status_code == 201:
        print("âœ… ArtykuÅ‚ zostaÅ‚ opublikowany z obrazkiem.")
    else:
        print(f"âŒ BÅ‚Ä…d publikacji posta: {response.text}")
ğŸ› ï¸ 2. PeÅ‚ny przykÅ‚ad â€“ integracja Unsplash + WordPress (dla Replit.com)
python
Kopiuj
Edytuj
import requests

def download_image(url):
    response = requests.get(url)
    if response.status_code == 200:
        return response.content
    else:
        raise Exception("Nie udaÅ‚o siÄ™ pobraÄ‡ obrazu.")

def upload_image_to_wp(image_data, filename, jwt_token):
    headers = {
        "Authorization": f"Bearer {jwt_token}",
        "Content-Disposition": f'attachment; filename="{filename}"',
        "Content-Type": "image/jpeg"
    }

    res = requests.post("https://twojblog.pl/wp-json/wp/v2/media", headers=headers, data=image_data)
    if res.status_code == 201:
        return res.json()['id']
    else:
        print(res.text)
        raise Exception("BÅ‚Ä…d wysyÅ‚ania zdjÄ™cia.")

def create_post(title, content, excerpt, featured_media_id, jwt_token):
    headers = {
        "Authorization": f"Bearer {jwt_token}",
        "Content-Type": "application/json"
    }

    post_data = {
        "title": title,
        "content": content,
        "excerpt": excerpt,
        "status": "publish",
        "featured_media": featured_media_id,
        "tags": [],
        "categories": []
    }

    res = requests.post("https://twojblog.pl/wp-json/wp/v2/posts", json=post_data, headers=headers)
    if res.status_code == 201:
        print("âœ… Post opublikowany z obrazkiem.")
    else:
        print(f"âŒ BÅ‚Ä…d publikacji posta: {res.text}")
ğŸ“¢ Komunikat dla agenta (prompt programistyczny w Replit.com):
âœ… ArtykuÅ‚ zostaÅ‚ poprawnie opublikowany na blogu przez API WordPressa â€“ tytuÅ‚, treÅ›Ä‡, tagi, kategorie sÄ… OK.
âŒ Jednak agent nie przypisuje featured image (obrazka gÅ‚Ã³wnego) do artykuÅ‚u, mimo Å¼e pobierany jest z Unsplash, Pexels lub Google Image.
ğŸ”§ Zadanie: zaimplementuj przesyÅ‚anie zdjÄ™cia jako media przez endpoint /wp-json/wp/v2/media, pobierz jego ID, a nastÄ™pnie przypisz je do pola featured_media podczas tworzenia posta przez REST API WordPressa.

ğŸ“Œ Alternatywna Å›cieÅ¼ka: fallback z Pexels lub Google Images
JeÅ›li obraz z Unsplash nie zadziaÅ‚a â€“ moÅ¼esz zastosowaÄ‡ fallback (rezerwowy mechanizm). Wystarczy dodaÄ‡ w kodzie:

python
Kopiuj
Edytuj
try:
    image_data = download_image(unsplash_url)
except:
    print("âŒ Unsplash failed, trying Pexels...")
    image_data = download_image(pexels_url)
